# Grafana OpenTelemetry Configuration for Spring Petclinic
# Service identification (CRITICAL for App Observability)
otel.service.name=spring-petclinic
otel.service.version=4.0.0
otel.resource.attributes=deployment.environment=production,service.version=4.0.0,service.namespace=petclinic

# OTLP Exporter Configuration
otel.exporter.otlp.endpoint=https://otlp-gateway-prod-us-east-0.grafana.net/otlp
otel.exporter.otlp.protocol=http/protobuf
otel.exporter.otlp.headers=Authorization=Basic%20Z2xjX2V5SnZJam9pTVRBMU5Ea3lNeUlzSW00aU9pSnpjSEpwYm1jdGNHVjBZMnhwYm1sakxYUnZhMlZ1SWl3aWF5STZJazV6T1RBek1XSnhlVFl3V0cwMmJXaERNRE40TjFOUFRDSXNJbTBpT25zaWNpSTZJbkJ5YjJRdGRYTXRaV0Z6ZEMwd0luMTk6ODYwNTg1

# Enable exporters
otel.traces.exporter=otlp
otel.metrics.exporter=otlp
otel.logs.exporter=otlp

# Metric collection and export settings
otel.metric.export.interval=60000
otel.metrics.exemplars.enabled=true

# Span attributes - promote key resource attributes to span attributes for App O11y
otel.instrumentation.common.default-enabled=true
otel.instrumentation.micrometer.enabled=true

# HTTP instrumentation with enhanced attributes
otel.instrumentation.spring-webmvc.enabled=true
otel.instrumentation.spring-webmvc.capture-request-headers=true
otel.instrumentation.spring-webmvc.capture-response-headers=true
otel.instrumentation.http.client.capture-request-headers=true
otel.instrumentation.http.capture-headers.client.request=User-Agent
otel.instrumentation.http.capture-headers.server.request=User-Agent

# Database instrumentation
otel.instrumentation.jdbc.enabled=true
otel.instrumentation.jdbc-datasource.enabled=true
otel.instrumentation.hibernate.enabled=true
otel.instrumentation.spring-data.enabled=true

# Additional instrumentations for better observability
otel.instrumentation.caffeine.enabled=true
otel.instrumentation.logback-appender.enabled=true
otel.instrumentation.runtime-telemetry.enabled=true

# Debug logging to troubleshoot trace export
otel.javaagent.debug=true
otel.traces.sampler=always_on
